<!doctype html><html lang=en><head><title>EN: Gynvael's Mission 016 :: Foxtrotlabs — In the middle of somewhere</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="My task I wasn&amp;rsquo;t in a hurry to accomplish mission no. 016 (in decimal), because I&amp;rsquo;m an author of this mess ;) So in this post I will show &amp;ldquo;my intended solution&amp;rdquo;. Before we begin, I want to give a huge shoutout to my IRC mate, who have told me a lot about a SSTV and a ham radio. This inspired me to create this mission. Kudos to @fishcake! The rating of this mission was done by @Gynvael."><meta name=keywords content="hacking"><meta name=robots content="noodp"><link rel=canonical href=https://foxtrotlabs.cc/2017/10/en-gynvaels-mission-016/><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-148414315-1","auto"),ga("send","pageview"))</script><link rel=stylesheet href=https://foxtrotlabs.cc/assets/style.css><link rel=stylesheet href=https://foxtrotlabs.cc/assets/blue.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://foxtrotlabs.cc/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href><meta name=twitter:card content="summary"><meta name=twitter:creator content="foxtrot_charlie"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="EN: Gynvael's Mission 016 :: Foxtrotlabs"><meta property="og:description" content="My task I wasn&amp;rsquo;t in a hurry to accomplish mission no. 016 (in decimal), because I&amp;rsquo;m an author of this mess ;) So in this post I will show &amp;ldquo;my intended solution&amp;rdquo;. Before we begin, I want to give a huge shoutout to my IRC mate, who have told me a lot about a SSTV and a ham radio. This inspired me to create this mission. Kudos to @fishcake! The rating of this mission was done by @Gynvael."><meta property="og:url" content="https://foxtrotlabs.cc/2017/10/en-gynvaels-mission-016/"><meta property="og:site_name" content="EN: Gynvael's Mission 016"><meta property="og:image" content><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="en"><meta property="article:section" content="ctf"><meta property="article:section" content="gynvaelstream"><meta property="article:published_time" content="2017-10-06 12:23:46 +0200 +0200"></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=https://foxtrotlabs.cc/en><div class=logo>foxtrotlabs-en</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=https://foxtrotlabs.cc/posts>posts</a></li><li><a href=https://foxtrotlabs.cc/pl>Polish side</a></li><li><a href=https://foxtrotlabs.cc/about>about</a></li><li><a href=https://github.com/s3gm3nt4ti0nf4ult>github</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=https://foxtrotlabs.cc/posts>posts</a></li><li><a href=https://foxtrotlabs.cc/pl>Polish side</a></li><li><a href=https://foxtrotlabs.cc/about>about</a></li><li><a href=https://github.com/s3gm3nt4ti0nf4ult>github</a></li></ul></nav><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-148414315-1","auto"),ga("send","pageview"))</script></header><div class=content><div class=post><h1 class=post-title><a href=https://foxtrotlabs.cc/2017/10/en-gynvaels-mission-016/>EN: Gynvael&rsquo;s Mission 016</a></h1><div class=post-meta><span class=post-date>2017-10-06
</span><span class=post-author>::
foxtrot_charlie</span></div><span class=post-tags>#<a href=https://foxtrotlabs.cc/tags/security/>security</a>&nbsp;
#<a href=https://foxtrotlabs.cc/tags/gynvael/>gynvael</a>&nbsp;
#<a href=https://foxtrotlabs.cc/tags/stegano/>stegano</a>&nbsp;
#<a href=https://foxtrotlabs.cc/tags/hacking/>hacking</a>&nbsp;
#<a href=https://foxtrotlabs.cc/tags/ctf/>ctf</a>&nbsp;</span><div class=post-content><div><h3 id=my-task>My task<a href=#my-task class=hanchor arialabel=Anchor>&#8983;</a></h3><p>I wasn&rsquo;t in a hurry to accomplish mission no. 016 (in decimal), because I&rsquo;m an author of this mess ;) So in this post I will show &ldquo;my intended solution&rdquo;. Before we begin, I want to give a huge shoutout to my IRC mate, who have told me a lot about a SSTV and a ham radio. This inspired me to create this mission. <strong>Kudos to @fishcake!</strong> The rating of this mission was done by @Gynvael.</p><p>So what were the orders?</p><pre tabindex=0><code>MISSION 016               goo.gl/zqvPQD             DIFFICULTY: ████████░░ [8╱10]
┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅
                                                    Operation codename: &#34;Pasokon&#34;

During the operational game our spy (codename &#34;Martin&#34;) managed to intercept
hostile communication.

  goo.gl/MoYBAx

Unfortunately, we have no idea how to decode it. To make matters worse, our most
well versed in crypto agent (codename &#34;Scottie&#34;) is on a mission right now and
cannot help us. Your handler advised to use your skills.

The fate of the Chunar rests in your hands!

And remember - if something is not clear, you have a license to bruteforce.

Good luck!
Over and out.

--

If you find the answer, put it in the comments under this video! If you write a
blogpost / post your solution / code online, please add a link as well!

P.S. I&#39;ll show/explain the solution in a video in one or two weeks.
P.S.2. This mission was brought to you by foxtrot_charlie!
</code></pre><p>Oh hack&mldr; All specialists are deployed, so once again we have to save the world ;) today&rsquo;s world is called &ldquo;Chunar&rdquo;&mldr;</p><h3 id=intel>Intel<a href=#intel class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Let&rsquo;s start simply by downloading a file that is located under a link shown in a mission description.</p><p><img src=https://foxtrotlabs.cc/pics/GLS016PL/downloading.png alt=downloading></p><p>What is it?</p><p><img src=https://foxtrotlabs.cc/pics/GLS016PL/file_intel.png alt=intel></p><p>Huh, a txt file with some weird encoding. If you scroll down, there is a <code>=</code> sign.</p><p><img src=https://foxtrotlabs.cc/pics/GLS016PL/cat_txt.png alt=base64></p><p>Adding a charset the straight conclusion hits my mind. This is base64! Let&rsquo;s decode it with commandline tool.<br><code>cat mission_file.txt | base64 -d > somefile</code><br>This command will create binary file. By <code>file</code>, a radare2 <code>\m</code> or simply a hexeditor we can identify this bytes as a wav file. So it&rsquo;s a sound! Let&rsquo;s play it!<br><code>mv somefile somefile.wav</code><br>This is not the music unfortunately. Let&rsquo;s use <code>audacity</code> and search for some patterns in this file.</p><p><img src=https://foxtrotlabs.cc/pics/GLS016PL/audacity.png alt="audacity waterfall"></p><p>Definitely there is a encoded message. But how to get it? <a href=https://www.sigidwiki.com/wiki/Database>This link</a> should help. Searching by waterfall image shows that this characteristic pattern belongs to the <code>SSTV</code> <a href=https://www.sigidwiki.com/wiki/Slow-Scan_Television_(SSTV)>(Slow-Scan Television)</a>. You can even play a sample file to be 100% sure with the identification.
Honestly this was the hardest part of this task. Looking at weird <em>codenames</em> in the description also hints that the SSTV was used to encode image.</p><h3 id=solve>Solve!<a href=#solve class=hanchor arialabel=Anchor>&#8983;</a></h3><p>I used software called <a href=http://users.belgacom.net/hamradio/rxsstv.htm>RX-SSTV</a> to obtain the image. It looks like this:</p><p><img src=https://foxtrotlabs.cc/pics/GLS016PL/rx_sstv.png alt="decoded message"></p><p>To get the best quality I suggest to either redirect sound from output to input in your soundcard settings or simply put microphone inside close shells of headphones. This is how I got mine. The type of encoding should be automatically discovered by the software. It was <code>robot36</code> that was not mentioned in the description ;) Now message looks like:</p><pre tabindex=0><code>REPORT ONE:


? ? R O N
D I Y M A
U Z ? ? ?
B C K P ?
? ? V W X 

Y DHXDMW BQLF KDYNV

Over and out. 
</code></pre><p>So this is not the end of this challenge. Remember what the description told us, if something is not clear it is good to bruteforce it just in case. First and the most important thing is to identify used cipher. What we see is a 5x5 letters matrix. Some of them are blurred. There aren&rsquo;t many ciphers that use this kind of matrix. The most popular one is a <code>Playfair</code>. Searching for it in Wiki gives us the name of Lyon Playfair. Check where he was born ;) - if you weren&rsquo;t convinced then now you should. So this cipher is the Playfair. Unfortunately the radio transmissions are vulnerable to some interference and we have to somehow recover damaged matrix to decode it. I really like the way of Pawel&rsquo;s Lukasik thinking. So if you are interested in cryptanalytic way of finding out the flag check out his <a href=https://ctfs.ghost.io/gynvaelen-mission-16-solution>blogpost</a>! In such cases I prefer to use the power of CPU and simply try all combinations. I use my Playfair library and this dirty Python script:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> playfair
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> itertools
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>	ph <span style=color:#f92672>=</span> playfair<span style=color:#f92672>.</span>Playfair()
</span></span><span style=display:flex><span>	left <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;E&#34;</span>, <span style=color:#e6db74>&#34;F&#34;</span>, <span style=color:#e6db74>&#34;G&#34;</span>, <span style=color:#e6db74>&#34;H&#34;</span>, <span style=color:#e6db74>&#34;L&#34;</span>, <span style=color:#e6db74>&#34;Q&#34;</span>, <span style=color:#e6db74>&#34;S&#34;</span>, <span style=color:#e6db74>&#34;T&#34;</span>]
</span></span><span style=display:flex><span>	part1 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;RONDIYMAUZ&#34;</span>
</span></span><span style=display:flex><span>	part2<span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;BCKP&#34;</span>
</span></span><span style=display:flex><span>	part3 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;VWX&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> list(itertools<span style=color:#f92672>.</span>permutations(left, <span style=color:#ae81ff>8</span>)):
</span></span><span style=display:flex><span>		pswd <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(i[:<span style=color:#ae81ff>2</span>]) <span style=color:#f92672>+</span> part1 <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(i[<span style=color:#ae81ff>2</span>:<span style=color:#ae81ff>5</span>]) <span style=color:#f92672>+</span> part2 <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(i[<span style=color:#ae81ff>5</span>:]) <span style=color:#f92672>+</span> part3
</span></span><span style=display:flex><span>		ph<span style=color:#f92672>.</span>setPassword(pswd)
</span></span><span style=display:flex><span>		dc <span style=color:#f92672>=</span> ph<span style=color:#f92672>.</span>decrypt(<span style=color:#e6db74>&#39;Y DHXDMW BQLF KDYNV&#39;</span>)
</span></span><span style=display:flex><span>		dc <span style=color:#f92672>=</span> dc[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>+</span> dc[<span style=color:#ae81ff>1</span>:<span style=color:#ae81ff>7</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>+</span> dc[<span style=color:#ae81ff>7</span>:<span style=color:#ae81ff>11</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>+</span> dc[<span style=color:#ae81ff>11</span>:]
</span></span><span style=display:flex><span>		print(<span style=color:#e6db74>&#34;Password: </span><span style=color:#e6db74>{}</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>message </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>format(pswd, dc))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>	main()
</span></span></code></pre></div><p>to decrypt password. The output of this program can be redirected to a file and then using some command like this <code>fgrep -f "first-file" "second-file"</code> with dictionary like rockyou.txt or simply trying to find the line that matches English words the most, the most <code>English</code> flag will be found.</p><p>The flag is <code>I ALWAYS PLAY FAIRX</code>. This <code>X</code> comes from the fact that the Playfair cipher needs even number of letters.</p><p>That&rsquo;s all. I hope you&rsquo;ve enjoyed the mission. I had a lot of fun creating it! From this place I want to give kudos to <a href=https://gitlab.com/snippets/1677928>Adrian Laskowski</a>. He didn&rsquo;t solve the mission (although he was really close), but he have decoded SSTV bare hand! Gratz, I&rsquo;m impressed! And kudos to all of you, who solved the mission ;) Thank you for your writeups!</p><p>If you are interested what was the password, well I was trying to randomize Playfair&rsquo;s board a little bit ;) This is how I&rsquo;ve encoded the message using <a href=http://rumkin.com/tools/cipher/playfair.php>this</a> website:</p><p><img src=https://foxtrotlabs.cc/pics/GLS016PL/original.png alt=original></p><p>And this is how the image looked before blurring some stuff:</p><p><img src=https://foxtrotlabs.cc/pics/GLS016PL/deblurred.png alt="before bluring"></p><p><strong>foxtrot_charlie</strong> over and out!</p></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>copyright by foxtrot_charlie</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://foxtrotlabs.cc/assets/main.js></script><script src=https://foxtrotlabs.cc/assets/prism.js></script></div></body></html>