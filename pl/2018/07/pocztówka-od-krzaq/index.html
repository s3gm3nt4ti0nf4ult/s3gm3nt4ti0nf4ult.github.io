<!doctype html><html lang=pl><head><title>Pocztówka od KrzaQ :: FoxtrotLabs — Tam gdzie bajty mówią dobranoc</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="**foxtrot_charlie znów napis... a nie napisał posta - Gynvael Coldwind** 0x0. Nieoczekiwana przesyłka czyli jak trafiłem do dzienniczka Czasami śledząc losy takich agentów jak popularny Thomas, zastanawiam się jak (nie)wiele potrzeba, aby trafić na watchlistę trzyliterowej firmy sponsorowanej z budżetu państwa. Jak bardzo musiałbym się postarać? W podobnym zamyśleniu trwałem w momencie wyciągania poczty, ze skrzynki, pewnego środowego poranka. I w tym momencie w moje ręce wpadła pocztówka. Ot taka zaadresowana do @foxtrot_charlie."><meta name=keywords content="hacking"><meta name=robots content="noodp"><link rel=canonical href=https://foxtrotlabs.cc/pl/2018/07/poczt%C3%B3wka-od-krzaq/><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-148414315-1","auto"),ga("send","pageview"))</script><link rel=stylesheet href=https://foxtrotlabs.cc/assets/style.css><link rel=stylesheet href=assets/%25!s%28%3cnil%3e%29.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://foxtrotlabs.cc/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href><meta name=twitter:card content="summary"><meta name=twitter:creator content="foxtrot_charlie"><meta property="og:locale" content="pl"><meta property="og:type" content="article"><meta property="og:title" content="Pocztówka od KrzaQ :: FoxtrotLabs"><meta property="og:description" content="**foxtrot_charlie znów napis... a nie napisał posta - Gynvael Coldwind** 0x0. Nieoczekiwana przesyłka czyli jak trafiłem do dzienniczka Czasami śledząc losy takich agentów jak popularny Thomas, zastanawiam się jak (nie)wiele potrzeba, aby trafić na watchlistę trzyliterowej firmy sponsorowanej z budżetu państwa. Jak bardzo musiałbym się postarać? W podobnym zamyśleniu trwałem w momencie wyciągania poczty, ze skrzynki, pewnego środowego poranka. I w tym momencie w moje ręce wpadła pocztówka. Ot taka zaadresowana do @foxtrot_charlie."><meta property="og:url" content="https://foxtrotlabs.cc/pl/2018/07/poczt%C3%B3wka-od-krzaq/"><meta property="og:site_name" content="Pocztówka od KrzaQ"><meta property="og:image" content><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="misc"><meta property="article:section" content="postcard"><meta property="article:section" content="crypto"><meta property="article:published_time" content="2018-07-05 23:24:51 +0200 +0200"></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=https://foxtrotlabs.cc/pl><div class=logo>foxtrotlabs-pl</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=https://foxtrotlabs.cc/pl/posts>posty</a></li><li><a href=https://foxtrotlabs.cc/>English side</a></li><li><a href=https://foxtrotlabs.cc/pl/about>o mnie</a></li><li><a href=https://github.com/s3gm3nt4ti0nf4ult>github</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=https://foxtrotlabs.cc/pl/posts>posty</a></li><li><a href=https://foxtrotlabs.cc/>English side</a></li><li><a href=https://foxtrotlabs.cc/pl/about>o mnie</a></li><li><a href=https://github.com/s3gm3nt4ti0nf4ult>github</a></li></ul></nav><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-148414315-1","auto"),ga("send","pageview"))</script></header><div class=content><div class=post><h1 class=post-title><a href=https://foxtrotlabs.cc/pl/2018/07/poczt%C3%B3wka-od-krzaq/>Pocztówka od KrzaQ</a></h1><div class=post-meta><span class=post-date>2018-07-05</span>
<span class=post-author>::
foxtrot_charlie</span></div><span class=post-tags>#<a href=https://foxtrotlabs.cc/pl/tags/kq/>kq</a>&nbsp;
#<a href=https://foxtrotlabs.cc/pl/tags/poczt%C3%B3wka/>pocztówka</a>&nbsp;
#<a href=https://foxtrotlabs.cc/pl/tags/crypto/>crypto</a>&nbsp;</span><div class=post-content><div><center>**foxtrot_charlie znów napis... a nie napisał posta - Gynvael Coldwind**</center><h3 id=0x0-nieoczekiwana-przesyłka-czyli-jak-trafiłem-do-dzienniczka>0x0. Nieoczekiwana przesyłka czyli jak trafiłem do dzienniczka<a href=#0x0-nieoczekiwana-przesyłka-czyli-jak-trafiłem-do-dzienniczka class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Czasami śledząc losy takich <code>agentów</code> jak popularny Thomas, zastanawiam się jak (nie)wiele potrzeba, aby trafić na watchlistę trzyliterowej firmy sponsorowanej z budżetu państwa. Jak bardzo musiałbym się postarać? W podobnym zamyśleniu trwałem w momencie wyciągania poczty, ze skrzynki, pewnego środowego poranka. I w tym momencie w moje ręce wpadła pocztówka. Ot taka zaadresowana do <code>@foxtrot_charlie</code>.</p><p><em><strong>Świetnie</strong></em> pomyślałem spoglądając na tę część, która z reguły zawiera kilka miłych dla adresata słów, teraz to już na pewno taka <code>firma</code> doda sobie mnie <em>do znajomych</em>.</p><p><img src=https://foxtrotlabs.cc/pics/PKQ2018/back.png alt="Backend of the postcard"></p><h3 id=0x1-biuro-szyfrów-i-spraw-beznadziejnych>0x1. Biuro Szyfrów i Spraw Beznadziejnych<a href=#0x1-biuro-szyfrów-i-spraw-beznadziejnych class=hanchor arialabel=Anchor>&#8983;</a></h3><p>No dobra, skoro <code>orzeł wylądował</code> to wypadałoby coś z tym fantem zrobić. Trochę z obawą zająłem się rozwiązywaniem tej łamigłówki, no bo jakby mi nie wyszło&mldr; to jak to tak&mldr; <em>cough</em> niehackersko <em>cough</em>! Wiem! Powiem, że mi się zgubiła&mldr; Nie, słabe to, muszę rozwiązać. No nic, ** failure is not an option ** jak to mówią.</p><h6 id=1-przepisujemy>1. Przepisujemy!<a href=#1-przepisujemy class=hanchor arialabel=Anchor>&#8983;</a></h6><p>Powiedzmy sobie szczerze, operowanie bitami znacznie szybciej przychodzi naszym kwarcowym kumplom niż białkowcom. Po zdigitalizowaniu otrzymujemy coś takiego:</p><pre tabindex=0><code>
51 63 70 62   63 61 78 6c   63 20 6e 6d
78 62 70 6d   75 67 63 6c   67 79 20 78
20 4c 6d 75   63 65 6d 20   48 6d 70 69
73 21 0a 0a   69 6f 0a
</code></pre><h6 id=2-łamiemy>2. Łamiemy!<a href=#2-łamiemy class=hanchor arialabel=Anchor>&#8983;</a></h6><p>Na pierwszy rzut oka wszystkie wartości są zawierają się w przedziale ASCII, więc może szyfrowanie nie jest aż takie trudne? Sprawdźmy.</p><p>Krótki helper w <code>Pythonie</code> i otrzymujemy:</p><pre tabindex=0><code>Qcpbcaxlc nmxbpmugclgy x Lmucem Hmpis!

io
</code></pre><p>Chyba jest dobrze&mldr; Mamy coś co przypomina wyrażenie zgodne z jakimś językiem, wszystkie znaki należą do <code>ASCII</code>, nie mamy żadnych <em>krzaczków</em> (KrzaQ ;D). Czyli pewnie zastosowano jakiś szyfr podstawieniowy. To jest moment w którym powiedziałem sobie <em>to &ldquo;io&rdquo; to będzie podpis kq</em>. Stąd droga do rozwiązania łamigłówki już krótka. Za każdy znak podstawiamy jego odpowiednik &ldquo;oddalony&rdquo; w alfabecie o określony offset. Dla każdego przesunięcia printujemy rozwiązanie. Jedno z nich wygląda następująco:</p><pre tabindex=0><code>Serdeczne pozdrowienia z Nowego Jorku!

kq
</code></pre><p>BINGO! Chciałem tylko nadmienić, że mój zmysł łowcy od razu podpowiedział mi, że <code>io -> kq</code>, #aniemowilem?</p><p>Dziękuję serdecznie za śliczną pocztówkę <code>KrzaQ</code>! Publicznie zobowiązuję się do zajęcia Ci chwili podobną wiadomością!</p><p>To jeszcze panorama Nowego Jorku:</p><p><img src=https://foxtrotlabs.cc/pics/PKQ2018/front.png alt="frontend of the postcard"></p><h3 id=epilog>Epilog<a href=#epilog class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Zgodnie z założeniami tego typu postów, mają one nieść ze sobą pewną wartość merytoryczną. Dlatego przedstawiam krótki kod, którym rozwiązałem to zadanie. Oczywiście da się to zrobić ładniej, krócej, szybciej, ale tak jak w przypadku CTFów: <code>what works works</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> string
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> codecs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>rot</span>(i, text):
</span></span><span style=display:flex><span>    <span style=color:#75715e># prosta i przyjemna w użyciu funkcja maketrans zamieni nam odpowiadające</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># literki (operuje na bajtach stąd .encode())</span>
</span></span><span style=display:flex><span>    rotI <span style=color:#f92672>=</span> bytes<span style=color:#f92672>.</span>maketrans(
</span></span><span style=display:flex><span>        string<span style=color:#f92672>.</span>ascii_letters<span style=color:#f92672>.</span>encode(),
</span></span><span style=display:flex><span>        string<span style=color:#f92672>.</span>ascii_letters[i:]<span style=color:#f92672>.</span>encode() <span style=color:#f92672>+</span> string<span style=color:#f92672>.</span>ascii_letters[:i]<span style=color:#f92672>.</span>encode()
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># zwracamy &#34;przetłumaczoną&#34; wiadomość zdekodowaną do ascii</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> codecs<span style=color:#f92672>.</span>decode(text<span style=color:#f92672>.</span>encode()<span style=color:#f92672>.</span>translate(rotI))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39; 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    zawartość postcard.txt:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        51 63 70 62   63 61 78 6c   63 20 6E 6D
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        78 62 70 6D   75 67 63 6c   67 79 20 78
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        20 4c 6d 75   63 65 6d 20   48 6d 70 69
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        73 21 0a 0a   69 6f 0a
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># wczytujemy kartkę z pliku postcard.txt i zamieniamy na ascii</span>
</span></span><span style=display:flex><span>    ptcard <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join([chr(int(x, <span style=color:#ae81ff>16</span>)) <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> open(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;./postcard.txt&#39;</span>)<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39; &#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;   &#39;</span>, <span style=color:#e6db74>&#39; &#39;</span>)<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34; &#34;</span>)])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Wynikiem działania jest:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Qcpbcaxlc nmxbpmugclgy x Lmucem Hmpis!
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    io
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># teraz najważniejsza część, czyli dla każdego przesunięcia (rotX)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># tworzymy odpowiadający mu string</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(string<span style=color:#f92672>.</span>ascii_letters)):
</span></span><span style=display:flex><span>        print(rot(i, ptcard))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p>Przy okazji postanowiłem pobawić się i stworzyć niezbyt czytelnego onelinera, który również rozwiąże łamigłówkę:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span></code></pre></div><p>foxtrot_charlie</p></div></div><link rel=stylesheet href=https://foxtrotlabs.cc/comments.css><section class=post-comments><script src=https://www.google.com/recaptcha/api.js></script><h1 id=Comments>Comments<a href=#Comments class=hanchor arialabel=Anchor>&#8983;</a></h1><font size=1>My comments operate on free Heroku instance. If there is no traffic in 30 minutes the dyno service goes asleep. That causes a small delay in submitting your comment. Thank you for your patience ;)</font><p>Nothing yet.</p><h3>Say something</h3><form class=post-new-comment method=post action=https://flabs-staticman.herokuapp.com/v2/entry/s3gm3nt4ti0nf4ult/page_source/master/comments><input type=hidden name=options[redirect] value=https://foxtrotlabs.cc/pl/2018/07/poczt%C3%B3wka-od-krzaq/#comment-submitted>
<input type=hidden name=options[entryId] value=8ecc3bfafbfa01fa7aca7354607b3de3>
<input name=fields[name] type=text class=post-comment-field placeholder="Your name">
<input name=fields[email] type=email class=post-comment-field placeholder="Your email address">
<textarea name=fields[body] class=post-comment-field placeholder="Your message. Feel free to use Markdown." rows=10></textarea>
<input type=hidden name=options[reCaptcha][siteKey] value=6Lco6bkZAAAAAPwhdzJftINmETZymWpv1s8w1hKR>
<input type=hidden name=options[reCaptcha][secret] value="cNVL1K9Iu23KHkq4nAvjE8jFHYmFb1aJmvpOSSILJdZaUA07HolAG0UkqYzekmBKkxqNo4bAwKcPhGtIohOKp+PfBROWHhB+Vl+lGYQ9Z3+MTghdzhAZEC0V+Ti0WEvpfTXR7Lj6LUXwPNg+HRMj3/oYlou6vsz0cP1OSLPe9iMd4ZMGolwIaUowvWn9DVfU0eHKLAWUNXVRxFiBGcTKKbAd0JgR4ZtZs1VsPkhC3OlOsHm/yW2pA491SAQ0s820p+H1SncOd1kYE1h2gTL+oklzH+5CNz2V4xyq6Et4NLjinr0WGUN87eCFYUz+05wyEp+5lrG+uuq1eX2cBcfVoA=="></div><input type=submit class="post-comment-field btn" value=Submit><div class=g-recaptcha data-sitekey=6Lco6bkZAAAAAPwhdzJftINmETZymWpv1s8w1hKR></div></form></section><div id=comment-submitted class=dialog><h3>Thank you</h3><p>Your comment has been submitted and will be published once it has been approved.</p><p><a href=# class=btn>OK</a></p></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>copyright by foxtrot_charlie</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://foxtrotlabs.cc/assets/main.js></script>
<script src=https://foxtrotlabs.cc/assets/prism.js></script></div></body></html>