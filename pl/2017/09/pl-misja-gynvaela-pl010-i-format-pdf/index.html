<!DOCTYPE html>
<html lang="pl">
<head>
  
    <title>PL: Misja Gynvaela PL010 i format PDF :: FoxtrotLabs — Tam gdzie bajty mówią dobranoc</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="0x01 Wstęp. Kolejny blogpost, kolejna misja Gynveala. Rozszerzenie tego artykułu o wiadomości dotyczące samego formatu PDF pojawi się niebawem, gdy tylko będę miał czas aby go dokończyć. Tymczasem skupmy się na zadaniu.
MISJA 010 goo.gl/oAdvWe DIFFICULTY: ███░░░░░░░ [3/10] ┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅ Otrzymaliśmy dokument PDF w którym podobno jest zaszyta ukryta wiadomość. Zwracamy się do Ciebie z prośbą o jej odnalezienie: https://goo.gl/wgt94W Powodzenia! -- Odzyskaną wiadomość umieść w komentarzu pod tym video :) Linki do kodu/wpisów na blogu/etc z opisem rozwiązania są również mile widziane!" />
<meta name="keywords" content="hacking" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://foxtrotlabs.cc/pl/2017/09/pl-misja-gynvaela-pl010-i-format-pdf/" />


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-148414315-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


<link rel="stylesheet" href="https://foxtrotlabs.cc/assets/style.css">

  <link rel="stylesheet" href="assets/%25!s%28%3cnil%3e%29.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://foxtrotlabs.cc/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="">



<meta name="twitter:card" content="summary" />

<meta name="twitter:creator" content="" />


<meta property="og:locale" content="pl" />
<meta property="og:type" content="article" />
<meta property="og:title" content="PL: Misja Gynvaela PL010 i format PDF :: FoxtrotLabs">
<meta property="og:description" content="0x01 Wstęp. Kolejny blogpost, kolejna misja Gynveala. Rozszerzenie tego artykułu o wiadomości dotyczące samego formatu PDF pojawi się niebawem, gdy tylko będę miał czas aby go dokończyć. Tymczasem skupmy się na zadaniu.
MISJA 010 goo.gl/oAdvWe DIFFICULTY: ███░░░░░░░ [3/10] ┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅ Otrzymaliśmy dokument PDF w którym podobno jest zaszyta ukryta wiadomość. Zwracamy się do Ciebie z prośbą o jej odnalezienie: https://goo.gl/wgt94W Powodzenia! -- Odzyskaną wiadomość umieść w komentarzu pod tym video :) Linki do kodu/wpisów na blogu/etc z opisem rozwiązania są również mile widziane!" />
<meta property="og:url" content="https://foxtrotlabs.cc/pl/2017/09/pl-misja-gynvaela-pl010-i-format-pdf/" />
<meta property="og:site_name" content="PL: Misja Gynvaela PL010 i format PDF" />

  
    <meta property="og:image" content="">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2017-09-07 22:59:36 &#43;0200 &#43;0200" />












</head>
<body class="">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="https://foxtrotlabs.cc/pl">
  <div class="logo">
    foxtrotlabs-pl
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="https://foxtrotlabs.cc/pl/posts">posty</a></li>
        
      
        
          <li><a href="https://foxtrotlabs.cc/">English side</a></li>
        
      
        
          <li><a href="https://foxtrotlabs.cc/pl/about">o mnie</a></li>
        
      
        
          <li><a href="https://github.com/s3gm3nt4ti0nf4ult">github</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="https://foxtrotlabs.cc/pl/posts">posty</a></li>
      
    
      
        <li><a href="https://foxtrotlabs.cc/">English side</a></li>
      
    
      
        <li><a href="https://foxtrotlabs.cc/pl/about">o mnie</a></li>
      
    
      
        <li><a href="https://github.com/s3gm3nt4ti0nf4ult">github</a></li>
      
    
    
  </ul>
</nav>

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-148414315-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://foxtrotlabs.cc/pl/2017/09/pl-misja-gynvaela-pl010-i-format-pdf/">PL: Misja Gynvaela PL010 i format PDF</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2017-09-07 
      </span>
    
    
  </div>

  

  

  

  <div class="post-content"><div>
        <h3 id="0x01-wstęp">0x01 Wstęp.<a href="#0x01-wstęp" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Kolejny blogpost, kolejna misja Gynveala. Rozszerzenie tego artykułu o wiadomości dotyczące samego formatu PDF pojawi się niebawem, gdy tylko będę miał czas aby go dokończyć. Tymczasem skupmy się na zadaniu.</p>
<pre tabindex="0"><code>MISJA 010            goo.gl/oAdvWe                  DIFFICULTY: ███░░░░░░░ [3/10]
┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅

Otrzymaliśmy dokument PDF w którym podobno jest zaszyta ukryta wiadomość.
Zwracamy się do Ciebie z prośbą o jej odnalezienie:

  https://goo.gl/wgt94W

Powodzenia!

--

Odzyskaną wiadomość umieść w komentarzu pod tym video :)
Linki do kodu/wpisów na blogu/etc z opisem rozwiązania są również mile widziane!

P.S. Rozwiązanie zadania przedstawię na początku kolejnego livestreama.
P.S. Pomysłodawcą misji jest foxtrot_charlie.
</code></pre><p>No tak, ostatnia linia powstrzymała mnie przed wrzuceniem rozwiązania zaraz po streamie. Postanowiłem się trochę rozpisać. Na szczęście weny starczyło na tyle, że powstały dwa wpisy (znaczy jeden&hellip; ten drugi -dłuższy, o samym formacie PDF, powstaje).</p>
<h3 id="0x02-radare2-strikes-again">0x02 radare2 strikes again!<a href="#0x02-radare2-strikes-again" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Czytelnik, który podjął próbę rozwiązania PL010 misji ze <a href="https://youtu.be/UpGB9Ka6-Ps?t=5905">streamu</a> pewnie zastanawia się, po co tyle trudu i starań. Przecież jest tyle dobrego i niemal &ldquo;bezdotykowego&rdquo; software do <code>carvingu</code> plików, że nie potrzeba męczyć się z r2. Nie sposób się nie zgodzić, z pewną dozą braku automatyzmu w radare2. Niemniej jednak misje Gyna uczą i bawią. Stwierdziłem, że chętnie poćwiczę manualny carving za pomocą r2 i przedstawię Czytelnikowi alternatywną ścieżkę dotarcia do flagi. Może skojarzenie z tym postem pomoże w przyszłości rozwiązać bardziej skomplikowany problem, którego nie dałoby się tak łatwo rozwiązać za pomocą binwalka czy <a href="https://github.com/sleuthkit/scalpel">scalpela</a>.</p>
<p>Cały proces poprawnego rozwiązania przedstawia poniższy terminalcast (walczę jeszcze z łatwą konwersją na gify, dlatego dziś użyję jeszcze JavaScriptu. Tak, jest mi wstyd&hellip;):</p>
<script type="text/javascript" src="https://asciinema.org/a/137785.js" id="asciicast-137785" async></script>
<p>Początkowo pobieramy plik, następnie wyszukujemy w nim <a href="https://en.wikipedia.org/wiki/List_of_file_signatures"><code>magic numbers</code></a>, za pomocą <code>\m</code>. Okazuje się, że pod adresem <code>0x4d5</code> znajduje się sygnatura formatu JPEG. BINGO! To może być to. Sprawdźmy, czy znajdziemy poprawny koniec pliku. W tym celu wyszukujemy dwa bajty końcowe tego formatu <code>\xFF\XD9</code>, do znalezienia tego ciągu (a także jego adresu) za pomocą radare2, użyjemy forward-slasha. Skoro określiliśmy już granice pliku jpeg, znajdującego się wewnątrz PDFa, czas wydobyć ten obrazek.
W tym celu skorzystam z polecenia <code>write to file</code>, czyli <code>wt</code>. Polecenie write, działa od obecnego przesunięcia (<code>seek</code>). Wynik dumpa zapisujemy do pliku <code>flaga.jpeg</code>.</p>
<p>Teraz wystarczy otworzyć w dowolnym programie do wyświetlania grafiki plik flag.jpeg, naszym oczom ukazuje się taki oto obrazek:</p>
<p><img src="https://foxtrotlabs.cc/pics/GLS010PLpdf/flag.jpeg" alt="flaga"></p>
<p>Wygląda na to, że otrzymaliśmy poprawny plik jpeg, który na dodatek zawiera sekret będący rozwiązaniem zadania.</p>
<h3 id="0x03-źródła">0x03 Źródła<a href="#0x03-źródła" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p><a href="https://raw.githubusercontent.com/corkami/pics/master/binary/PDF101.png">Corkami PDF101</a></p>
<p><a href="https://raw.githubusercontent.com/corkami/pics/master/binary/PDF.png">Corkami PDF</a></p>
<p><a href="http://radare.today/posts/carving-bins/">radare2 file carving</a></p>

      </div></div>

  

  <link rel="stylesheet" href="https://foxtrotlabs.cc/comments.css">
 <section class="post-comments">
  <script src='https://www.google.com/recaptcha/api.js'></script>
 

<h1 id="Comments">Comments<a href="#Comments" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<font size="1"> My comments operate on free Heroku instance. If there is no traffic in 30 minutes the dyno service goes asleep. That causes a small delay in submitting your comment. Thank you for your patience ;)</font>

  
  

  
    
  
    
  
    
  
    
  

  
    <p>Nothing yet.</p>
  

  <h3>Say something</h3>

  <form class="post-new-comment" method="POST" action="https://flabs-staticman.herokuapp.com/v2/entry/s3gm3nt4ti0nf4ult/page_source/master/comments">
    <input type="hidden" name="options[redirect]" value="https://foxtrotlabs.cc/pl/2017/09/pl-misja-gynvaela-pl010-i-format-pdf/#comment-submitted">
    <input type="hidden" name="options[entryId]" value="b29e8a8806561bec27a1cb2bb3ec6ebc">
    <input name="fields[name]" type="text" class="post-comment-field" placeholder="Your name">
    <input name="fields[email]" type="email" class="post-comment-field" placeholder="Your email address">
    <textarea name="fields[body]" class="post-comment-field" placeholder="Your message. Feel free to use Markdown." rows="10"></textarea>
    <input type="hidden" name="options[reCaptcha][siteKey]" value="6Lco6bkZAAAAAPwhdzJftINmETZymWpv1s8w1hKR">
    <input type="hidden" name="options[reCaptcha][secret]" value="cNVL1K9Iu23KHkq4nAvjE8jFHYmFb1aJmvpOSSILJdZaUA07HolAG0UkqYzekmBKkxqNo4bAwKcPhGtIohOKp+PfBROWHhB+Vl+lGYQ9Z3+MTghdzhAZEC0V+Ti0WEvpfTXR7Lj6LUXwPNg+HRMj3/oYlou6vsz0cP1OSLPe9iMd4ZMGolwIaUowvWn9DVfU0eHKLAWUNXVRxFiBGcTKKbAd0JgR4ZtZs1VsPkhC3OlOsHm/yW2pA491SAQ0s820p+H1SncOd1kYE1h2gTL+oklzH+5CNz2V4xyq6Et4NLjinr0WGUN87eCFYUz+05wyEp+5lrG+uuq1eX2cBcfVoA=="></div>
    <input type="submit" class="post-comment-field btn" value="Submit">
     <div class="g-recaptcha" data-sitekey="6Lco6bkZAAAAAPwhdzJftINmETZymWpv1s8w1hKR"></div>
  </form>
</section>

<div id="comment-submitted" class="dialog">
<h3>Thank you</h3>
  <p>Your comment has been submitted and will be published once it has been approved.</p>
  <p><a href="#" class="btn">OK</a></p>
</div>

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">
        <span>copyright by foxtrot_charlie</span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://foxtrotlabs.cc/assets/main.js"></script>
<script src="https://foxtrotlabs.cc/assets/prism.js"></script>





  
</div>

</body>
</html>
