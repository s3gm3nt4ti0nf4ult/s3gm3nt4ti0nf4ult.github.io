<!doctype html><html lang=en><head><title>Advent of Cyber2 Day 0x01 :: Foxtrotlabs â€” In the middle of somewhere</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="0x00 Ho! Ho! Ho! December 1, the day on which the countdown begins. We don&amp;rsquo;t have much time to help our Santa deliver malicious payl^W pardon, I should talk about Santa in the red uniform not about red teaming. So as one may read, it&amp;rsquo;s only 24 days until Christmas and crackers/APTs/state actors are trying to ruin Christmas. This challenge was brought to you by John Hammond and I would consider it as easy one."><meta name=keywords content="hacking"><meta name=robots content="noodp"><link rel=canonical href=https://foxtrotlabs.cc/2020/12/advent-of-cyber2-day-0x01/><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-148414315-1","auto"),ga("send","pageview"))</script><link rel=stylesheet href=https://foxtrotlabs.cc/assets/style.css><link rel=stylesheet href=https://foxtrotlabs.cc/assets/blue.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://foxtrotlabs.cc/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href><meta name=twitter:card content="summary"><meta name=twitter:creator content="foxtrot_0xf4ult"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Advent of Cyber2 Day 0x01 :: Foxtrotlabs"><meta property="og:description" content="AoC2 Day 0x01 Web Challenge solution"><meta property="og:url" content="https://foxtrotlabs.cc/2020/12/advent-of-cyber2-day-0x01/"><meta property="og:site_name" content="Advent of Cyber2 Day 0x01"><meta property="og:image" content="https://foxtrotlabs.cc/2020/12/advent-of-cyber2-day-0x01/title.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2020-12-01 18:38:59 +0100 +0100"></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=https://foxtrotlabs.cc/en><div class=logo>foxtrotlabs-en</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=https://foxtrotlabs.cc/posts>posts</a></li><li><a href=https://foxtrotlabs.cc/pl>Polish side</a></li><li><a href=https://foxtrotlabs.cc/about>about</a></li><li><a href=https://github.com/s3gm3nt4ti0nf4ult>github</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=https://foxtrotlabs.cc/posts>posts</a></li><li><a href=https://foxtrotlabs.cc/pl>Polish side</a></li><li><a href=https://foxtrotlabs.cc/about>about</a></li><li><a href=https://github.com/s3gm3nt4ti0nf4ult>github</a></li></ul></nav><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-148414315-1","auto"),ga("send","pageview"))</script></header><div class=content><div class=post><h1 class=post-title><a href=https://foxtrotlabs.cc/2020/12/advent-of-cyber2-day-0x01/>Advent of Cyber2 Day 0x01</a></h1><div class=post-meta><span class=post-date>2020-12-01</span></div><span class=post-tags>#<a href=https://foxtrotlabs.cc/tags/http/>http</a>&nbsp;
#<a href=https://foxtrotlabs.cc/tags/web/>web</a>&nbsp;
#<a href=https://foxtrotlabs.cc/tags/exploitation/>exploitation</a>&nbsp;
#<a href=https://foxtrotlabs.cc/tags/cookies/>cookies</a>&nbsp;
#<a href=https://foxtrotlabs.cc/tags/hacking/>hacking</a>&nbsp;
#<a href=https://foxtrotlabs.cc/tags/ctf/>ctf</a>&nbsp;
#<a href=https://foxtrotlabs.cc/tags/easychalls/>easychalls</a>&nbsp;
#<a href=https://foxtrotlabs.cc/tags/re/>re</a>&nbsp;
</span><img src=https://foxtrotlabs.cc/2020/12/advent-of-cyber2-day-0x01/title.png class=post-cover alt="Advent of Cyber2 Day 0x01"><div class=post-content><div><h2 id=0x00-ho-ho-ho>0x00 Ho! Ho! Ho!<a href=#0x00-ho-ho-ho class=hanchor arialabel=Anchor>&#8983;</a></h2><p>December 1, the day on which the countdown begins. We don&rsquo;t have much time to help our Santa deliver malicious payl^W pardon, I should talk about Santa in the red uniform not about red teaming. So as one may read, it&rsquo;s only 24 days until Christmas and crackers/APTs/state actors are trying to ruin Christmas. This challenge was brought to you by John Hammond and I would consider it as easy one.</p><h2 id=0x01-task>0x01 Task<a href=#0x01-task class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Control Center is a control panel for assembly lines in gift factory.</p><p><img src=loginpanel.png alt=Login_panel></p><p>The dashboard is portected by a login form. Trying random users (admin:admin) gives an error. But anyone can create an account on that website. Just remember to set passwords longer than 5 characters. (Thanx John, I was upset because my <code>asdf:asdf</code> didn&rsquo;t work).</p><p><img src=tooshort.png alt=Too_short></p><p><img src=foxtrot.png alt=Foxtrot_account></p><p>Like a hamrm! Immediately after logging the user gets the cookie. This time is pretty suspicious.</p><pre tabindex=0><code>7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a22666f7874726f74227d
</code></pre><p>is a hex encoded JSON string. After decoding using <a href=https://gchq.github.io/>cyberchef</a> the content is revealed: <code>{"company":"The Best Festival Company", "username":"foxtrot"}</code>. My first thought was to simply change the <code>username</code> value in the string, encode it and bang!</p><pre tabindex=0><code>7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a2273616e7461227d
</code></pre><p>stands for <code>{"company":"The Best Festival Company", "username":"santa"}</code>. What&rsquo;s funny I&rsquo;ve entered the answer in the THM site but with account name starting with the capital letter <code>S</code> (so <code>Santa</code> not <code>santa</code>). To my surprise the answer was accepted but unfortunately only in the TryHackMe dashboard. So after a small replacement, the correct value of the <code>auth</code> cookie was: ``</p><pre tabindex=0><code>7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a2273616e7461227d
</code></pre><p>This time bingo!</p><p><img src=services_start.png alt=services_start></p><p>We are in with Santa priviliages, so no it&rsquo;s only the matter of few clicks to spin up the production line.</p><p><img src=production_line.png alt=production_line></p><p>All services are up and runnin&rsquo; and the POST request used to obtain the flag gives us the answer for the first challenge.</p><p><img src=firstsolution.png alt=burp></p><p>That&rsquo;s all for today guys! Thanks for reading. What do you think about AoC2? I cannot wait for more advanced topics.</p></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>copyright by foxtrot_charlie</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://foxtrotlabs.cc/assets/main.js></script><script src=https://foxtrotlabs.cc/assets/prism.js></script></div></body></html>